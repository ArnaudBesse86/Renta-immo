<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculateur de rentabilité d'investissement locatif</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet">
    <link href="output.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Gabriela&display=swap');
        .font-gabriela {
            font-family: 'Gabriela', serif;
        }

        h1, h2, h3, button, a {
        font-family: 'Gabriela', serif!important;
        }
        
    </style>
</head>
<body class="bg-gray-100">
    <div class="container mx-auto px-4">
        <header class="py-6 flex justify-between items-center">
            <div class="flex flex-col items-center mx-0">
                <div class="w-1/6 aspect-[127/110] relative mb-2">
                   
                    <a href="index.html"><img class="w-full h-auto" viewBox="0 0 127 110" src="logo/calcul-rentabilite-immo_logo_immeuble.svg" alt="calcul Rentabilité Immo"></a>
                        
                </div>
                <h1 class="text-center whitespace-nowrap text-[4vw] sm:text-[2.5vw] md:text-[2vw] lg:text-[1.5vw] font-bold mb-1 font-gabriela">
                    <span class="text-[#2980B9]">Calcul</span>
                    <span class="text-[#96CA2D]">Rentabilité</span>
                    <span class="text-[#545454]">Immo</span>
                </h1>
                <div class="w-full flex justify-center">
                <img class="w-1/5 lg:w-1/4 h-auto" viewBox="0 0 171 30" src="logo/calcul-rentabilite-immo_logo_courbe.svg">

                </div>
                <p class="text-[#91AA9D] whitespace-nowrap text-[2.2vw] sm:text-[1.4vw] md:text-[1.2vw] lg:text-[0.8vw] mt-1">Votre guide pour investir simplement et sereinement</p>
            </div>
            
            <div id="userInfo" class="text-center text-[#96CA2D]">
                <p id="userName" class="text-center font-gabriela"></p>

                <button id="menuToggle" class="text-gray-600 hover:text-gray-900">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
            
        </header>

        <div id="mobileMenu" class="hidden bg-white p-4 rounded-lg shadow-lg mb-4">
            <ul class="space-y-2 mb-6">
                <li><a href="index.html#calculatorContainer" class="block text-gray-600 hover:text-gray-900">Calculateur de rentabilité</a></li>
                <li><a href="#guides-container" class="block text-gray-600 hover:text-gray-900">Liste des Guides et Articles sur l'investissement locatif immobilier</a></li>
                <li><a href="#guides-container" class="block text-gray-600 hover:text-gray-900">Retrouvez les études sur les villes dans lesquelles vous souhaitez investir</a></li>
            </ul>
            <div id="userInfoMobile" class="">
                <a href="myaccount.html" id="myaccountMobile" class="text-blue-500">Mon compte</a>
                <br /><br />
                <button id="logoutButtonMobile" class="text-blue-500 text-xs" style="display: none;">Se déconnecter</button>
            </div>

        </div>

        <main class="mt-10">
            <div id="calculatorContainer"></div>
            <div id="authContainer"></div>
            <div id="guides-container" class="">
                <!-- Les guides seront insérés ici dynamiquement -->
            </div> 

        </main>

    </div>

    <script type="module">
    // Importer les objets et fonctions depuis initbdd.js
    import { app, auth, db, onAuthStateChanged, signOut, signInWithEmailAndPassword, createUserWithEmailAndPassword, collection, getDocs, setDoc, doc, addDoc, getDoc, query, orderBy } from './initbdd.js';

// Vous pouvez maintenant utiliser les objets Firebase
    /*console.log(app);  // Devrait afficher l'instance Firebase
    console.log(auth); // Devrait afficher l'instance Auth
    console.log(db);   // Devrait afficher l'instance Firestore*/


        // Fonction pour obtenir les paramètres de l'URL
        function getUrlParameter(name) {
            name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
            var regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
            var results = regex.exec(location.search);
            return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
        }

        // Fonction pour charger et afficher les détails du guide
        async function loadGuideDetails() {
            const guideId = getUrlParameter('id');
            if (!guideId) {
                console.error('Aucun ID de guide trouvé dans l\'URL');
                return;
            }

            const guideRef = doc(db, 'Guides', guideId);

            try {
                const docSnap = await getDoc(guideRef);

                if (docSnap.exists()) {
                    const guideData = docSnap.data();
                    const guideContainer = document.getElementById('guides-container');

                    guideContainer.innerHTML = `
                    <div class="w-full lg:flex lg:flex-row lg:space-x-6">
                        <div class="w-full lg:w-1/2 mb-6 lg:mb-0">
                            <img src="${guideData.imageGuide}" alt="Guide icon" class="w-full h-auto object-cover rounded-lg shadow-md">
                        </div>
                        
                        <div class="w-full lg:w-1/2">
                            <h1 class="text-2xl lg:text-3xl font-bold mb-6">${guideData.TitreGuide}</h1>
                            
                            <div class="mt-4">
                                <p class="text-gray-700 leading-relaxed">${guideData.IntroductionGuide}</p>
                            </div>
                        </div>
                    </div>
                    <div class="divarticleguide w-full mt-6 text-gray-700 leading-relaxed">
                        ${guideData.ArticleGuide}
                        <p class="text-gray-700 leading-relaxed mt-10 border-2 border-dotted rounded p-6">${guideData.ConclusionGuide}</p>
                    </div>
                    `;
                } else {
                    console.log('Aucun guide trouvé avec cet ID');
                    guideContainer.innerHTML = '<p class="text-red-500">Guide non trouvé.</p>';
                }
            } catch (error) {
                console.error("Erreur lors du chargement du guide:", error);
                guideContainer.innerHTML = '<p class="text-red-500">Erreur lors du chargement du guide. Veuillez réessayer plus tard.</p>';
            }
        }

    // Initialisation
    window.onload = function() {
        loadGuideDetails();
    }
    </script>
<script type="module" src="fonctions.js"></script>

</body>
</html>